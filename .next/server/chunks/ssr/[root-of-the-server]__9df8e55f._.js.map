{"version":3,"sources":["turbopack:///[project]/src/app/auth/email/page.module.css [app-ssr] (css module)","turbopack:///[project]/src/app/auth/email/page.tsx"],"sourcesContent":["__turbopack_context__.v({\n  \"button\": \"page-module__S1Tu7W__button\",\n  \"card\": \"page-module__S1Tu7W__card\",\n  \"field\": \"page-module__S1Tu7W__field\",\n  \"header\": \"page-module__S1Tu7W__header\",\n  \"help\": \"page-module__S1Tu7W__help\",\n  \"input\": \"page-module__S1Tu7W__input\",\n  \"inputRow\": \"page-module__S1Tu7W__inputRow\",\n  \"isError\": \"page-module__S1Tu7W__isError\",\n  \"isOk\": \"page-module__S1Tu7W__isOk\",\n  \"label\": \"page-module__S1Tu7W__label\",\n  \"status\": \"page-module__S1Tu7W__status\",\n  \"subtitle\": \"page-module__S1Tu7W__subtitle\",\n  \"title\": \"page-module__S1Tu7W__title\",\n  \"wrap\": \"page-module__S1Tu7W__wrap\",\n});\n","'use client'\r\n\r\nimport { useEffect, useMemo, useState } from 'react'\r\nimport { createClient } from '@/lib/supabase'\r\nimport styles from './page.module.css'\r\n\r\nconst LS_KEY = 'recent_emails'\r\nconst MAX_RECENT = 5\r\n\r\nfunction loadRecentEmails(): string[] {\r\n  try {\r\n    const raw = localStorage.getItem(LS_KEY)\r\n    if (!raw) return []\r\n    const arr = JSON.parse(raw)\r\n    return Array.isArray(arr) ? arr.filter((e) => typeof e === 'string') : []\r\n  } catch { return [] }\r\n}\r\n\r\nfunction saveRecentEmail(email: string) {\r\n  try {\r\n    const current = loadRecentEmails()\r\n    const next = [email, ...current.filter((e) => e !== email)].slice(0, MAX_RECENT)\r\n    localStorage.setItem(LS_KEY, JSON.stringify(next))\r\n  } catch {}\r\n}\r\n\r\nexport default function EmailSignInPage() {\r\n  const supabase = createClient()\r\n\r\n  const [email, setEmail] = useState('')\r\n  const [status, setStatus] = useState<string>('')\r\n  const [sending, setSending] = useState(false)\r\n  const [recent, setRecent] = useState<string[]>([])\r\n\r\n  useEffect(() => {\r\n    setRecent(loadRecentEmails())\r\n  }, [])\r\n\r\n  const canSubmit = useMemo(() => {\r\n    const v = email.trim().toLowerCase()\r\n    // very light validation\r\n    return !!v && v.includes('@') && v.includes('.')\r\n  }, [email])\r\n\r\n  async function sendLink() {\r\n    const normalized = email.trim().toLowerCase()\r\n    if (!normalized) return\r\n    setSending(true)\r\n    setStatus('Sending...')\r\n\r\n    const { error } = await supabase.auth.signInWithOtp({\r\n      email: normalized,\r\n      options: {\r\n        emailRedirectTo: `${location.origin}/auth/callback`,\r\n        shouldCreateUser: true,\r\n      },\r\n    })\r\n\r\n    if (error) {\r\n      setStatus(`Error: ${error.message}`)\r\n    } else {\r\n      setStatus('Check your inbox for a magic link.')\r\n      saveRecentEmail(normalized)\r\n      setRecent(loadRecentEmails())\r\n    }\r\n    setSending(false)\r\n  }\r\n\r\n  return (\r\n    <main className={styles.wrap}>\r\n      <section className={styles.card} aria-labelledby=\"signin-title\">\r\n        <header className={styles.header}>\r\n          <h1 id=\"signin-title\" className={styles.title}>Sign in</h1>\r\n          <p className={styles.subtitle}>We’ll email you a magic link to continue.</p>\r\n        </header>\r\n\r\n        <div className={styles.field}>\r\n          <label htmlFor=\"email\" className={styles.label}>Email</label>\r\n          <div className={styles.inputRow}>\r\n            <input\r\n              id=\"email\"\r\n              className={styles.input}\r\n              type=\"email\"\r\n              inputMode=\"email\"\r\n              autoCapitalize=\"none\"\r\n              autoCorrect=\"off\"\r\n              spellCheck={false}\r\n              autoComplete=\"email\"\r\n              placeholder=\"you@example.com\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              list=\"recent-emails\"\r\n              aria-describedby=\"email-help\"\r\n            />\r\n            <datalist id=\"recent-emails\">\r\n              {recent.map((e) => <option key={e} value={e} />)}\r\n            </datalist>\r\n            <button\r\n              className={styles.button}\r\n              onClick={sendLink}\r\n              disabled={!canSubmit || sending}\r\n            >\r\n              {sending ? 'Sending…' : 'Send magic link'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {!!status && (\r\n          <div\r\n            className={\r\n              status.startsWith('Error')\r\n                ? `${styles.status} ${styles.isError}`\r\n                : `${styles.status} ${styles.isOk}`\r\n            }\r\n            role=\"status\"\r\n            aria-live=\"polite\"\r\n          >\r\n            {status}\r\n          </div>\r\n        )}\r\n      </section>\r\n    </main>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}